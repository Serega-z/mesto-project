(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){imageLink.src=e.target.currentSrc,imageLink.alt=e.target.alt,imageInfo.textContent=e.target.alt,n(popupLocationImage)}function n(e){e.classList.add("popup_opened"),document.addEventListener("keyup",r),e.addEventListener("click",c)}function o(){var e=document.querySelector(".popup_opened");e&&(e.classList.remove("popup_opened"),document.removeEventListener("keyup",r),e.removeEventListener("click",c))}function r(e){"Escape"===e.key&&o()}function c(e){e.target===e.currentTarget&&o()}e.d({},{ED:()=>j,f1:()=>x,kW:()=>m});var a=document.querySelector(".elements"),i=document.querySelector("#card").content;function u(e){var t=e.target.closest(".elements__element"),n=t.id,o=e.target.classList.contains("elements__like-container-liked"),r=t.querySelector(".elements__like-count"),c="PUT";o&&(c="DELETE"),function(e,t){return fetch("".concat(l,"/").concat(s,"/cards/likes/").concat(t),{method:e,headers:{authorization:d,"Content-Type":"application/json"}}).then((function(e){return e.json()}))}(c,n).then((function(t){r.textContent=t.likes.length,e.target.classList.toggle("elements__like-container-liked")}))}var l="https://nomoreparties.co/v1",d="92f03e12-2aa3-473a-b069-ac84e8ecd772",s="plus-cohort-8";function p(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove("popup__button_inactive"),t.disabled=""):(t.classList.add("popup__button_inactive"),t.disabled="disabled")}var m,f=document.querySelector(".profile__button_edit"),_=document.querySelector(".profile__button_add"),v=document.querySelector(".profile__button_edit-avatar"),y=document.querySelector("#profile"),h=document.querySelector("#editAvatar"),S=document.querySelector("#deleteCard"),L=document.querySelector("#addLocation"),E=document.forms.profile.elements.name,g=document.querySelector("#info"),k=document.querySelector(".profile__title"),q=document.querySelector(".profile__avatar"),b=document.querySelector(".profile__subtitle"),C=document.querySelector("#location"),T=document.querySelector("#image");function j(e){k.textContent=e.name,q.src=e.avatar,b.textContent=e.about,m=e._id}function x(e){S.id=e.target.parentElement.id,n(S)}fetch("".concat(l,"/").concat(s,"/users/me"),{headers:{authorization:d}}).then((function(e){return e.json()})).then((function(e){j(e)})),fetch("".concat(l,"/").concat(s,"/cards"),{headers:{authorization:d}}).then((function(e){return e.json()})).then((function(e){e.forEach((function(e){!function(e){var n,o,r,c,l,d,s;a.append((n=e,o=i.cloneNode(!0),r=o.querySelector(".elements__image"),c=o.querySelector(".elements__like-count"),l=o.querySelector("#cardId"),d=o.querySelector(".elements__delete-container"),s=o.querySelector(".elements__like-container"),l.id=n._id,l.name=n._id,r.src=n.link,r.alt=n.name,c.textContent=n.likes.length,1==n.likes.some((function(e){return e._id==m}))&&s.classList.toggle("elements__like-container-liked"),n.owner._id!==m&&(d.hidden=!0),o.querySelector(".elements__subtitle").textContent=n.name,o.querySelector(".elements__delete-container").addEventListener("click",x),s.addEventListener("click",u),r.addEventListener("click",t),o))}(e)}))})),Array.from(document.querySelectorAll(".popup__form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".popup__item")),n=e.querySelector(".popup__button");p(t,n),t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove("popup__item_error"),n.classList.remove("popup__item_error_active"),n.textContent=""}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add("popup__item_error"),o.textContent=n,o.classList.add("popup__item_error_active")}(e,t,t.validationMessage)}(e,o),p(t,n)}))}))}(e)})),f.addEventListener("click",(function(){E.value=k.innerText,g.value=b.innerText,n(y)})),_.addEventListener("click",(function(){n(L)})),v.addEventListener("click",(function(){n(h)})),L.addEventListener("submit",(function(e){e.preventDefault(),function(e,t){return fetch("".concat(l,"/").concat(s,"/cards"),{method:"POST",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return e.json()}))}(C.value,T.value).then((function(e){elements.prepend(createCard(e)),C.value="",T.value=""})),o()})),y.addEventListener("submit",(function(e){var t,n;e.preventDefault(),(t=E.value,n=g.value,fetch("".concat(l,"/").concat(s,"/users/me"),{method:"PATCH",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.json()}))).then((function(e){k.textContent=e.name,b.textContent=e.about,o()}))})),h.addEventListener("submit",(function(e){e.preventDefault(),fetch("".concat(l,"/").concat(s,"/users/me/avatar "),{method:"PATCH",headers:{authorization:d,"Content-Type":"application/json"},body:JSON.stringify({avatar:newAvatar.value})}).then((function(e){return e.json()})).then((function(e){q.src=e.avatar,o()}))})),S.addEventListener("submit",(function(e){var t;e.preventDefault(),(t=e.currentTarget.id,fetch("".concat(l,"/").concat(s,"/cards/").concat(t),{method:"DELETE",headers:{authorization:d,"Content-Type":"application/json"}}).then((function(e){return e.json()}))).then((function(t){e.target.id="",document.getElementById(element.currentTarget.id).remove(),o()}))})),document.querySelectorAll(".popup__button-close").forEach((function(e){e.addEventListener("click",o)}))})();