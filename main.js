(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add(O.activePopupClass),document.addEventListener("keyup",o),e.addEventListener("click",c)}function n(){var e=document.querySelector(".".concat(O.activePopupClass));e&&(e.classList.remove(O.activePopupClass),document.removeEventListener("keyup",o),e.removeEventListener("click",c))}function o(e){"Escape"===e.key&&n()}function c(e){e.target===e.currentTarget&&n()}function r(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(n.classList.remove(e.inactiveButtonClass),n.disabled=""):(n.classList.add(e.inactiveButtonClass),n.disabled="disabled")}e.d({},{Ac:()=>O});var i=document.querySelector(".elements"),a=document.querySelector("#card").content;function u(e,t,n,o,c){var r=a.cloneNode(!0),i=r.querySelector(".elements__image"),u=r.querySelector(".elements__like-count"),l=r.querySelector("#cardId"),s=r.querySelector(".elements__delete-container"),d=r.querySelector(".elements__like-container");return l.id=e._id,l.name=e._id,i.src=e.link,i.alt=e.name,u.textContent=e.likes.length,1==e.likes.some((function(e){return e._id==n}))&&d.classList.toggle("elements__like-container-liked"),e.owner._id!==n&&(s.hidden=!0),r.querySelector(".elements__subtitle").textContent=e.name,s.addEventListener("click",t),d.addEventListener("click",c),i.addEventListener("click",o),r}var l="https://nomoreparties.co/v1",s="92f03e12-2aa3-473a-b069-ac84e8ecd772",d="plus-cohort-8";function f(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var m,p,v=document.querySelector(".profile__button_edit"),_=document.querySelector(".profile__button_add"),y=document.querySelector("#profile"),h=document.querySelector("#editAvatar"),S=document.querySelector(".profile__button_edit-avatar"),q=document.querySelector("#deleteCard"),C=document.querySelector("#addLocation"),E=document.querySelector("#locationImage"),b=document.querySelector("#button-profile-submit"),g=document.querySelector("#button-location-submit"),L=document.querySelector("#button-edit-avatar-submit"),k=document.forms.profile.elements.name,x=document.querySelector("#info"),T=(document.querySelector("#card").content,document.querySelector("#location")),A=document.querySelector("#image"),P=E.querySelector(".popup__image"),j=E.querySelector(".popup__image-info"),z=document.querySelector(".profile__title"),B=document.querySelector(".profile__avatar"),D=document.querySelector(".profile__subtitle"),O={formSelector:".popup__form",inputSelecotor:".popup__item",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_inactive",inputErrorClass:"popup__item_error",inputErrorClassActive:"popup__item_error_active",activePopupClass:"popup_opened"};function N(e){q.id=e.target.parentElement.id,t(q)}function w(e,t,n){t.textContent=e?"Сохранение...":n}function I(e){P.src=e.target.currentSrc,P.alt=e.target.alt,j.textContent=e.target.alt,t(E)}function J(e){var t=e.target.closest(".elements__element"),n=t.id,o=e.target.classList.contains("elements__like-container-liked"),c=t.querySelector(".elements__like-count"),r="PUT";o&&(r="DELETE"),function(e,t){return fetch("".concat(l,"/").concat(d,"/cards/likes/").concat(t),{method:e,headers:{authorization:s,"Content-Type":"application/json"}}).then((function(e){return f(e)}))}(r,n).then((function(t){!function(e,t,n){e.textContent=n.likes.length,t.target.classList.toggle("elements__like-container-liked")}(c,e,t)}))}fetch("".concat(l,"/").concat(d,"/users/me"),{headers:{authorization:s}}).then((function(e){return f(e)})).then((function(e){!function(e){z.textContent=e.name,B.src=e.avatar,D.textContent=e.about,m=e._id}(e),fetch("".concat(l,"/").concat(d,"/cards"),{headers:{authorization:s}}).then((function(e){return f(e)})).then((function(e){e.forEach((function(e){!function(e){i.append(u(e,N,m,I,J))}(e)}))})).catch((function(e){console.log(e)}))})),p=O,Array.from(document.querySelectorAll(p.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(t.querySelectorAll(e.inputSelecotor)),o=t.querySelector(e.submitButtonSelector);r(e,n,o),n.forEach((function(c){c.addEventListener("input",(function(){!function(e,t,n){n.validity.valid?function(e,t,n){var o=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),o.classList.remove(e.inputErrorClassActive),o.textContent=""}(e,t,n):function(e,t,n,o){var c=t.querySelector(".".concat(n.id,"-error"));n.classList.add(e.inputErrorClass),c.textContent=o,c.classList.add(e.inputErrorClassActive)}(e,t,n,n.validationMessage)}(e,t,c),r(e,n,o)}))}))}(p,e)})),v.addEventListener("click",(function(){k.value=z.innerText,x.value=D.innerText,t(y)})),_.addEventListener("click",(function(){t(C),function(e,t){e.classList.add(t.inactiveButtonClass)}(g,O)})),S.addEventListener("click",(function(){t(h)})),C.addEventListener("submit",(function(e){e.preventDefault();var t=g.textContent;w(!0,g,t),function(e,t){return fetch("".concat(l,"/").concat(d,"/cards"),{method:"POST",headers:{authorization:s,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return f(e)}))}(T.value,A.value).then((function(e){i.prepend(u(e)),T.value="",A.value="",n()})).catch((function(e){console.log(e)})).finally((function(){w(!1,g,t)}))})),y.addEventListener("submit",(function(e){e.preventDefault();var t,o,c=b.textContent;w(!0,b,c),(t=k.value,o=x.value,fetch("".concat(l,"/").concat(d,"/users/me"),{method:"PATCH",headers:{authorization:s,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:o})}).then((function(e){return f(e)}))).then((function(e){z.textContent=e.name,D.textContent=e.about,n()})).catch((function(e){console.log(e)})).finally((function(){w(!1,b,c)}))})),h.addEventListener("submit",(function(e){e.preventDefault();var t=L.textContent;w(!0,L,t),fetch("".concat(l,"/").concat(d,"/users/me/avatar "),{method:"PATCH",headers:{authorization:s,"Content-Type":"application/json"},body:JSON.stringify({avatar:newAvatar.value})}).then((function(e){return f(e)})).then((function(e){B.src=e.avatar,n()})).catch((function(e){console.log(e)})).finally((function(){w(!1,L,t)}))})),q.addEventListener("submit",(function(e){e.preventDefault();var t,o=e.currentTarget.id;(t=o,fetch("".concat(l,"/").concat(d,"/cards/").concat(t),{method:"DELETE",headers:{authorization:s,"Content-Type":"application/json"}}).then((function(e){return f(e)}))).then((function(e){!function(e){document.getElementById(e).remove()}(o),n()})).catch((function(e){console.log(e)}))})),document.querySelectorAll(".popup__button-close").forEach((function(e){e.addEventListener("click",n)}))})();