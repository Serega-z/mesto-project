(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){z.src=e.target.currentSrc,z.alt=e.target.alt,B.textContent=e.target.alt,n(L)}function n(e){e.classList.add(w.activePopupClass),document.addEventListener("keyup",r),e.addEventListener("click",c)}function o(){var e=document.querySelector(".".concat(w.activePopupClass));e&&(e.classList.remove(w.activePopupClass),document.removeEventListener("keyup",r),e.removeEventListener("click",c))}function r(e){"Escape"===e.key&&o()}function c(e){e.target===e.currentTarget&&o()}function a(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?(n.classList.remove(e.inactiveButtonClass),n.disabled=""):(n.classList.add(e.inactiveButtonClass),n.disabled="disabled")}e.d({},{f1:()=>I,em:()=>B,oP:()=>z,s4:()=>L,kW:()=>v,Ac:()=>w});var i="https://nomoreparties.co/v1",u="92f03e12-2aa3-473a-b069-ac84e8ecd772",l="plus-cohort-8";function s(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var d=document.querySelector(".elements"),m=document.querySelector("#card").content;function p(e){var n=m.cloneNode(!0),o=n.querySelector(".elements__image"),r=n.querySelector(".elements__like-count"),c=n.querySelector("#cardId"),a=n.querySelector(".elements__delete-container"),i=n.querySelector(".elements__like-container");return c.id=e._id,c.name=e._id,o.src=e.link,o.alt=e.name,r.textContent=e.likes.length,1==e.likes.some((function(e){return e._id==v}))&&i.classList.toggle("elements__like-container-liked"),e.owner._id!==v&&(a.hidden=!0),n.querySelector(".elements__subtitle").textContent=e.name,n.querySelector(".elements__delete-container").addEventListener("click",I),i.addEventListener("click",f),o.addEventListener("click",t),n}function f(e){var t=e.target.closest(".elements__element"),n=t.id,o=e.target.classList.contains("elements__like-container-liked"),r=t.querySelector(".elements__like-count"),c="PUT";o&&(c="DELETE"),function(e,t){return fetch("".concat(i,"/").concat(l,"/cards/likes/").concat(t),{method:e,headers:{authorization:u,"Content-Type":"application/json"}}).then((function(e){return s(e)}))}(c,n).then((function(t){r.textContent=t.likes.length,e.target.classList.toggle("elements__like-container-liked")}))}var v,_,y=document.querySelector(".profile__button_edit"),h=document.querySelector(".profile__button_add"),S=document.querySelector("#profile"),q=document.querySelector("#editAvatar"),C=document.querySelector(".profile__button_edit-avatar"),E=document.querySelector("#deleteCard"),b=document.querySelector("#addLocation"),L=document.querySelector("#locationImage"),k=document.querySelector("#button-profile-submit"),g=document.querySelector("#button-location-submit"),x=document.querySelector("#button-edit-avatar-submit"),T=document.forms.profile.elements.name,A=document.querySelector("#info"),P=(document.querySelector("#card").content,document.querySelector("#location")),j=document.querySelector("#image"),z=L.querySelector(".popup__image"),B=L.querySelector(".popup__image-info"),D=document.querySelector(".profile__title"),O=document.querySelector(".profile__avatar"),N=document.querySelector(".profile__subtitle"),w={formSelector:".popup__form",inputSelecotor:".popup__item",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_inactive",inputErrorClass:"popup__item_error",inputErrorClassActive:"popup__item_error_active",activePopupClass:"popup_opened"};function I(e){E.id=e.target.parentElement.id,n(E)}function J(e,t,n){t.textContent=e?"Сохранение...":n}fetch("".concat(i,"/").concat(l,"/cards"),{headers:{authorization:u}}).then((function(e){return s(e)})).then((function(e){e.forEach((function(e){!function(e){d.append(p(e))}(e)}))})),_=w,Array.from(document.querySelectorAll(_.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(t.querySelectorAll(e.inputSelecotor)),o=t.querySelector(e.submitButtonSelector);a(e,n,o),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){n.validity.valid?function(e,t,n){var o=t.querySelector(".".concat(n.id,"-error"));n.classList.remove(e.inputErrorClass),o.classList.remove(e.inputErrorClassActive),o.textContent=""}(e,t,n):function(e,t,n,o){var r=t.querySelector(".".concat(n.id,"-error"));n.classList.add(e.inputErrorClass),r.textContent=o,r.classList.add(e.inputErrorClassActive)}(e,t,n,n.validationMessage)}(e,t,r),a(e,n,o)}))}))}(_,e)})),fetch("".concat(i,"/").concat(l,"/users/me"),{headers:{authorization:u}}).then((function(e){return s(e)})).then((function(e){return function(e){D.textContent=e.name,O.src=e.avatar,N.textContent=e.about,v=e._id}(e)})),y.addEventListener("click",(function(){T.value=D.innerText,A.value=N.innerText,n(S)})),h.addEventListener("click",(function(){n(b),g.classList.add(w.inactiveButtonClass)})),C.addEventListener("click",(function(){n(q)})),b.addEventListener("submit",(function(e){e.preventDefault();var t=g.textContent;J(!0,g,t),function(e,t){return fetch("".concat(i,"/").concat(l,"/cards"),{method:"POST",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return s(e)}))}(P.value,j.value).then((function(e){d.prepend(p(e)),P.value="",j.value=""})),J(!1,g,t),o()})),S.addEventListener("submit",(function(e){e.preventDefault();var t,n,r=k.textContent;J(!0,k,r),(t=T.value,n=A.value,fetch("".concat(i,"/").concat(l,"/users/me"),{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return s(e)}))).then((function(e){D.textContent=e.name,N.textContent=e.about,J(!1,k,r),o()}))})),q.addEventListener("submit",(function(e){e.preventDefault();var t=x.textContent;J(!0,x,t),fetch("".concat(i,"/").concat(l,"/users/me/avatar "),{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({avatar:newAvatar.value})}).then((function(e){return s(e)})).then((function(e){O.src=e.avatar,J(!1,x,t),o()}))})),E.addEventListener("submit",(function(e){e.preventDefault();var t,n=e.currentTarget.id;(t=n,fetch("".concat(i,"/").concat(l,"/cards/").concat(t),{method:"DELETE",headers:{authorization:u,"Content-Type":"application/json"}}).then((function(e){return s(e)}))).then((function(e){document.getElementById(n).remove(),o()}))})),document.querySelectorAll(".popup__button-close").forEach((function(e){e.addEventListener("click",o)}))})();